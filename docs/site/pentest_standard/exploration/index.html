<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="darkcode0x00 luizcorrea">
        <link rel="canonical" href="https://darkcode357.github.io/thg-framework/pentest_standard/exploration/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Exploitation - thg-framework</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/purebasic.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">thg-framework</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../cli/install/">Installation</a>
</li>
                                    
<li >
    <a href="../..">Introduction</a>
</li>
                                    
<li >
    <a href="../../community/">Community</a>
</li>
                                    
<li >
    <a href="../../conceptual/">Conceptual</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">english <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">capture the flag</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">basic</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">analysis</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/analysis/linux/">linux</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/analysis/windows/">windows</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/analysis/malware/">malware</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">recovery</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/recover/backuo/">backup</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/recover/patching/">patching</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">tips_end_tricks</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/tools/">tools</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/decoding/">decoding</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/dos/">dos</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/os_cheats/">os_cheats</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/tips_end_tricks/snort/">snort</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">identify</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/identify/basic/">basic</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/nmap/">nmap</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/nessus/">nessus</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/openvas/">openvas</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/windows/">windows</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/identify/linux/">linux</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">defend</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/prootect_defend/windows/">windows</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/prootect_defend/linux/">linux</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">identify</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/detect/tcpdump/">tcpdump</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/editcap/">edicap</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/mergecap/">mergecap</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/snort/">snort</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/tshark/">tshark</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/analysis/">analysis</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">os</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/basic/detect/linux/">linux</a>
</li>
            
<li >
    <a href="../../capturetheflag/basic/detect/windows/">windows</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
<li >
    <a href="../../deployment/">Deployment</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">hash_crack</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../capturetheflag/hash_crack/">index</a>
</li>
            
<li >
    <a href="../../capturetheflag/hash_crack/CORE_HASH_CRACKING_KNOWLEDGE/">CORE_HASH_CRACKING_KNOWLEDGE</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">pentest_standard</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../preengagemente/">Pre engagement Interactions</a>
</li>
            
<li >
    <a href="../ig/">Intelligence Gathering</a>
</li>
            
<li >
    <a href="../threatmodeling/">Threat Modeling</a>
</li>
            
<li >
    <a href="../vulnterability/">Vulnerability Analysis</a>
</li>
            
<li class="active">
    <a href="./">Exploitation</a>
</li>
            
<li >
    <a href="../postexploration/">Post Exploitation</a>
</li>
            
<li >
    <a href="../report/">Reporting</a>
</li>
            
<li >
    <a href="../tecguidelines/">Technical Guidelines</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">CLI <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">THG-PART-1</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/thg/">THG</a>
</li>
            
<li >
    <a href="../../tutorials/server/">thg_server</a>
</li>
            
<li >
    <a href="../../tutorials/version/">thg_version</a>
</li>
            
<li >
    <a href="../../tutorials/shells/">thg_shells</a>
</li>
            
<li >
    <a href="../../tutorials/thg_docs/">thg_docs</a>
</li>
            
<li >
    <a href="../../tutorials/auxiliares/">thg_auxiliares</a>
</li>
            
<li >
    <a href="../../tutorials/anti_forensic/">thg_anti_forensic</a>
</li>
            
<li >
    <a href="../../tutorials/crypto/">thg_crypto</a>
</li>
            
<li >
    <a href="../../tutorials/drone/">thg_drone</a>
</li>
            
<li >
    <a href="../../tutorials/keylogger/">thg_keylogger</a>
</li>
            
<li >
    <a href="../../tutorials/recon/">thg_recon</a>
</li>
            
<li >
    <a href="../../tutorials/voip/">thg_voip</a>
</li>
            
<li >
    <a href="../../tutorials/automation/">thg_automation</a>
</li>
            
<li >
    <a href="../../tutorials/cryptography/">thg_cryptography</a>
</li>
            
<li >
    <a href="../../tutorials/exploitation/">thg_exploitation</a>
</li>
            
<li >
    <a href="../../tutorials/malware/">thg_malware</a>
</li>
            
<li >
    <a href="../../tutorials/reversing/">thg_reversing</a>
</li>
            
<li >
    <a href="../../tutorials/thg_windows/">thg_windows</a>
</li>
            
<li >
    <a href="../../tutorials/automobile/">thg_automobile</a>
</li>
            
<li >
    <a href="../../tutorials/database/">thg_database</a>
</li>
            
<li >
    <a href="../../tutorials/fingerprint/">thg_fingerprint</a>
</li>
            
<li >
    <a href="../../tutorials/misc/">thg_misc</a>
</li>
            
<li >
    <a href="../../tutorials/sniffer/">thg_sniffer</a>
</li>
            
<li >
    <a href="../../tutorials/wireless/">thg_wireless</a>
</li>
            
<li >
    <a href="../../tutorials/debugger/">thg_debugger</a>
</li>
            
<li >
    <a href="../../tutorials/firmware/">thg_firmware</a>
</li>
            
<li >
    <a href="../../tutorials/mobile/">thg_mobile</a>
</li>
            
<li >
    <a href="../../tutorials/social/">thg_social</a>
</li>
            
<li >
    <a href="../../tutorials/backdoor/">thg_backdoor</a>
</li>
            
<li >
    <a href="../../tutorials/decompiler/">thg_decompiler</a>
</li>
            
<li >
    <a href="../../tutorials/forensic/">thg_forensic</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">THG-PART-2</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/networking/">thg_networking</a>
</li>
            
<li >
    <a href="../../tutorials/spoff/">thg_spoff</a>
</li>
            
<li >
    <a href="../../tutorials/binary/">thg_binary</a>
</li>
            
<li >
    <a href="../../tutorials/defensensive/">thg_defensensive</a>
</li>
            
<li >
    <a href="../../tutorials/gpu/">thg_gpu</a>
</li>
            
<li >
    <a href="../../tutorials/os/">thg_os</a>
</li>
            
<li >
    <a href="../../tutorials/nfc/">thg_nfc</a>
</li>
            
<li >
    <a href="../../tutorials/spoof/">thg_spoof</a>
</li>
            
<li >
    <a href="../../tutorials/version/">thg_version</a>
</li>
            
<li >
    <a href="../../tutorials/bluetooth/">thg_bluetooth</a>
</li>
            
<li >
    <a href="../../tutorials/defensive/">thg_defensive</a>
</li>
            
<li >
    <a href="../../tutorials/hardware/">thg_hardware</a>
</li>
            
<li >
    <a href="../../tutorials/packer/">thg_packer</a>
</li>
            
<li >
    <a href="../../tutorials/stego/">thg_stego</a>
</li>
            
<li >
    <a href="../../tutorials/code_audit/">thg_code_audit</a>
</li>
            
<li >
    <a href="../../tutorials/disassembler/">thg_disassembler</a>
</li>
            
<li >
    <a href="../../tutorials/honeypot/">thg_honeypot</a>
</li>
            
<li >
    <a href="../../tutorials/proxy/">thg_proxy</a>
</li>
            
<li >
    <a href="../../tutorials/tunnel/">thg_tunnel</a>
</li>
            
<li >
    <a href="../../tutorials/cracker/">thg_cracker</a>
</li>
            
<li >
    <a href="../../tutorials/dos/">thg_dos</a>
</li>
            
<li >
    <a href="../../tutorials/ids/">thg_ids</a>
</li>
            
<li >
    <a href="../../tutorials/radio/">thg_radio</a>
</li>
            
<li >
    <a href="../../tutorials/unpacker/">thg_unpacker</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contributing <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../contributing/get-started/">Get Started</a>
</li>
                                    
<li >
    <a href="../../cli/templates/">templates</a>
</li>
                                    
<li >
    <a href="../../cli/build/">build</a>
</li>
                                    
<li >
    <a href="../../cli/tags/">tags</a>
</li>
                                    
<li >
    <a href="../../LICENSE/">LICENSE</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../vulnterability/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../postexploration/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/darkcode357/thg-framework/edit/master/docs/pentest_standard/exploration.md">Edit on darkcode357/thg-framework</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#purpose">Purpose</a></li>
        <li class="main "><a href="#countermeasures">Countermeasures</a></li>
            <li><a href="#anti-virus">Anti-Virus</a></li>
            <li><a href="#human">Human</a></li>
            <li><a href="#data-execution-prevention-dep">Data Execution Prevention (DEP)</a></li>
            <li><a href="#address-space-layout-randomization">Address Space Layout Randomization</a></li>
            <li><a href="#web-application-firewall-waf">Web Application Firewall (WAF)</a></li>
        <li class="main "><a href="#evasion">Evasion</a></li>
        <li class="main "><a href="#precision-strike">Precision Strike</a></li>
        <li class="main "><a href="#customized-exploitation-avenue">Customized Exploitation Avenue</a></li>
        <li class="main "><a href="#tailored-exploits">Tailored Exploits</a></li>
            <li><a href="#exploit-customization">Exploit Customization</a></li>
        <li class="main "><a href="#zero-day-angle">Zero-Day Angle</a></li>
            <li><a href="#fuzzing">Fuzzing</a></li>
            <li><a href="#source-code-analysis">Source Code Analysis</a></li>
            <li><a href="#types-of-exploits">Types of Exploits</a></li>
            <li><a href="#traffic-analysis">Traffic Analysis</a></li>
            <li><a href="#physical-access">Physical Access</a></li>
            <li><a href="#proximity-access-wifi">Proximity Access (WiFi)</a></li>
        <li class="main "><a href="#example-avenues-of-attack">Example Avenues of Attack</a></li>
        <li class="main "><a href="#overall-objective">Overall Objective</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h2 id="purpose">Purpose<a class="headerlink" href="#purpose" title="Permanent link">&para;</a></h2>
<p>The exploitation phase of a penetration test focuses solely on establishing access to a system or resource by bypassing security restrictions. If the prior phase, vulnerability analysis was performed properly, this phase should be well planned and a precision strike..  The main focus is to identify the main entry point into the organization and to identify high value target assets.</p>
<p>If the vulnerability analysis phase was properly completed, a high value target list should have been complied. Ultimately the attack vector should take into consideration the success probability and highest impact on the organization.</p>
<h2 id="countermeasures">Countermeasures<a class="headerlink" href="#countermeasures" title="Permanent link">&para;</a></h2>
<p>Countermeasures are defined as preventative technology or controls that hinder the ability to successfully complete an exploit avenue. This technology could be a Host Based Intrusion Prevention System, Security Guard, Web Application Firewall, or other preventative methods. When performing an exploit, several factors should be taken into consideration. In the event of a preventative technology, a circumvention technique should be considered. In circumstances when this is not possible, alternative exploit methods should be considered.</p>
<p>Overall, the purpose is to remain stealth when attacking the organization, if alarms are tripped the level of the assessment could be diminished. If at all possible, the countermeasures should be enumerated prior to triggering the exploit. This could be done through doing dry runs of the attack or enumerating the technology. </p>
<h3 id="anti-virus">Anti-Virus<a class="headerlink" href="#anti-virus" title="Permanent link">&para;</a></h3>
<p>Anti-virus is a technology aimed at preventing malicious software from being deployed on the system. As a penetration tester we should be able to identify these types of anti-virus technologies and be able to protect against them. Anti-virus is a small subset of all of the different preventative measures that can be in place, for example host-based intrusion prevention systems, web application firewalls, and other preventative technologies.</p>
<h4 id="encoding">Encoding<a class="headerlink" href="#encoding" title="Permanent link">&para;</a></h4>
<p>Encoding is the method of obfuscating data in a way that makes the deployed piece of code not appear the same. With encoding, the obfuscation occurs usually by scrambling the information and re-arranging in order to hide the fact of what the application is actually doing.</p>
<h4 id="packing">Packing<a class="headerlink" href="#packing" title="Permanent link">&para;</a></h4>
<p>Packing is similar to encoding in a sense in that it attempts to re-arrange data to compress the application or &ldquo;pack&rdquo; it. The hopes of this is that the executable or piece of code being delivered is obfuscated in a manner that it won&rsquo;t be picked up by anti-virus technologies.</p>
<h4 id="encrypting">Encrypting<a class="headerlink" href="#encrypting" title="Permanent link">&para;</a></h4>
<p>Encrypting, like Encoding and Packing is another method of manipulating the intended runnable code such that it is not recognizable or available for inspection. Only after decrypting in in-memory (with methods similar to packing) the actual code is exposed for the first time - hopefully after security mechanisms have allowed it through and it is executed immediately after it is decrypted.</p>
<h4 id="whitelist-bypass">Whitelist Bypass<a class="headerlink" href="#whitelist-bypass" title="Permanent link">&para;</a></h4>
<p>Whitelisting technologies leveraged a trusted model for applications that have been seen on a given system at a time. The technology takes a baseline of the system and identifies what is normal to be run on the system versus what is something foreign. The penetration tester should be able to circumvent whitelist technologies. One of the most common methods is through direct memory access. Whitelisting does not have the capbility of monitoring memory real time and if a memory resident program is running and not touching disk, it can run without being detect by the given technology.</p>
<h4 id="process-injection">Process Injection<a class="headerlink" href="#process-injection" title="Permanent link">&para;</a></h4>
<p>Process injection is simply the method to inject into an already running process. By injecting into a process, the information of the application can be hidden within a process that would normally be trusted in nature. It&rsquo;s very difficult for preventative measure technology to inspect running processes and can almost always hide in a different process that the application would think is a trusted one.</p>
<h4 id="purely-memory-resident">Purely Memory Resident<a class="headerlink" href="#purely-memory-resident" title="Permanent link">&para;</a></h4>
<p>Memory resident attacks are generally the most preferred as most technologies do not inspect memory. As an attacker, finding a way to live in memory purely would be most desirable. When writing to disk, most applications will conduct scans, baselines, and other identifications of potentially maliicous software. The ability to be detected when writing to disk becomes significantly greater.</p>
<h3 id="human">Human<a class="headerlink" href="#human" title="Permanent link">&para;</a></h3>
<p>When performing exploitation, it is not always the best route to go through a direct exploit or through an application flaw. Sometimes the human element may be a better way to attack an organization. It&rsquo;s important to understand the right attack avenue and make sure that the method we are leveraging is the best route to take.</p>
<h3 id="data-execution-prevention-dep">Data Execution Prevention (DEP)<a class="headerlink" href="#data-execution-prevention-dep" title="Permanent link">&para;</a></h3>
<p>When performing exploitation, many preventative measures canc ome into play. Data Execution Prevention is a defensive measure implemented into most operating systems and prevents execute permission when an overwrite in memory has occurred. The thought process behind DEP is to stop an attacker in rewriting memory and then executing that code. There are mulitple methods to bypass data execution prevention and discussed later in the the exploitation phase of PTES.</p>
<h3 id="address-space-layout-randomization">Address Space Layout Randomization<a class="headerlink" href="#address-space-layout-randomization" title="Permanent link">&para;</a></h3>
<p>During a buffer overflow vulnerability (or that of anything where we control memory), memory addresses are hardcoded in order redirect execution flow to our shellcode. In the event of ASLR, certain bytes are randomized in order to prevent an attacker from predicting where he/she can always go to in order to execute shellcode.</p>
<h3 id="web-application-firewall-waf">Web Application Firewall (WAF)<a class="headerlink" href="#web-application-firewall-waf" title="Permanent link">&para;</a></h3>
<p>Web application firewalls are a technology that sits inline with an application in order to protect against web-based application attacks. Web application firewalls attempt to identify potentially dangerous or malforms attacked towards a given web applciation and prevent them. There are a number of bypass techniques for web application firewalls and should be tested during the penetration test.</p>
<h2 id="evasion">Evasion<a class="headerlink" href="#evasion" title="Permanent link">&para;</a></h2>
<p>Evasion is the technique used in order to escape detection during a penetration test. This could be circumventing a camera system as to not be seen by a guard, obfuscating your payloads to evade Intrusion Detection Systems (IDS) or Intrusion Prevention Systems (IPS) or encoding requests/responses to circumvent web application firewalls. Overall, the need to identify a low risk scenario for evading a technology or person should be formulated prior to the exploit.</p>
<h2 id="precision-strike">Precision Strike<a class="headerlink" href="#precision-strike" title="Permanent link">&para;</a></h2>
<p>The main focus of a penetration test is to simulate an attacker in order to represent a simulated attack against the organization. The value brought through a penetration test is generally not through smash and grab techniques where the attacks are noisy in nature and in an attempt to try every exploit. This approach may be particularly useful at the end of a penetration test to gauge the level of incident response from the organization, but in most cases the exploitation phase is a accumulation of specific research on the target.</p>
<h2 id="customized-exploitation-avenue">Customized Exploitation Avenue<a class="headerlink" href="#customized-exploitation-avenue" title="Permanent link">&para;</a></h2>
<p>Every attack will typically not be the same in how the exploitation avenue occurs. In order to be successful in this phase, the attack should be tailored and customized based on the scenario. For example, if a wireless penetration test is occurred, and a specific technology is in use, these need to be identified and attacked based on what technologies are in place.  Having a clear understanding of each scenario and the applicability of an exploit is one of the most important aspects of this phase of the penetration test.</p>
<h2 id="tailored-exploits">Tailored Exploits<a class="headerlink" href="#tailored-exploits" title="Permanent link">&para;</a></h2>
<p>In a number of occasions the exploits that are public on the Internet may need some work in order to successfully complete. In most cases, if an exploit is designed for Windows XP SP2, specific modifications to the exploit will be required in order for the attack to be successful via Windows XP  SP3. The penetration tester should have the knowledge in place to be able to customize an exploit and the ability to change on the fly in order to successfully complete the attack.</p>
<h3 id="exploit-customization">Exploit Customization<a class="headerlink" href="#exploit-customization" title="Permanent link">&para;</a></h3>
<p>In the event of an attack, it is often required to simulate the victims infrastructure in order to ensure that the exploitation phase will be successful. The techniques leveraged in the information gathering phase can always help assist in that however, having a working infrastructure and systems in place will make the expliotation phase much easier. In the event of a tailored exploit, the penetration tester should be able to customize already public exploits in order to successfully attack a system. A common theme for exploits is to target specific versions of operating systems or applications. The reason for this is due to memory addresses changing based on service packs, and/or new versions of the operating system. The tester should be able to customize these exploits to successfully deploy to different operating systems and successfully compromise the system.</p>
<h2 id="zero-day-angle">Zero-Day Angle<a class="headerlink" href="#zero-day-angle" title="Permanent link">&para;</a></h2>
<p>In most cases, the zero-day angle is often a last resort for most penetration testers. This type of attack often represents a highly advanced organization that can handle a focused attack against the organization through normal attack methods. In certain scenarios research may be conducted in order to reverse engineer, fuzz, or perform advanced discovery of vulnerabilities that have not been discovered. In the event this type of attack is applicable, ensure that the environment to the best of the attackers knowledge is reproduced to include countermeasure technology.</p>
<p>In order for zero-day exploits to be successful (or any exploit for that matter), having the same operating system, patches, and countermeasures is highly important on success. Sometimes this information may not be available based on the level of access or enumeration that has occurred.</p>
<h3 id="fuzzing">Fuzzing<a class="headerlink" href="#fuzzing" title="Permanent link">&para;</a></h3>
<p>Fuzzing is the ability to recreate a protocol or application and attempt to send data at the application in hopes of identification of a vulnerability. Often times the hopes of a fuzzer is to identify a crash in an application and craft a specific exploit out of it. In the case of fuzzing, the attacker is attempting to create a specific vulnerability out of something that hasn&rsquo;t been discovered before. As part of a penetration test, if no avenues are identified during the engagement, or the engagement calls for zero-day research; fuzzing techniques should be leveraged in order to identify potentially vulnerable exposures.</p>
<h3 id="source-code-analysis">Source Code Analysis<a class="headerlink" href="#source-code-analysis" title="Permanent link">&para;</a></h3>
<p>Other avenues that a penetration tester has available is if the source code is available or open-source. If the tester has the ability to look at the source code and identify flaws within the application, zero day exposures can also be identified through these methods.</p>
<h3 id="types-of-exploits">Types of Exploits<a class="headerlink" href="#types-of-exploits" title="Permanent link">&para;</a></h3>
<p>There are several types of exploits that can be identified during a penetration test that could be classified as a zero-day. Some are listed in this section.</p>
<h4 id="buffer-overflows">Buffer Overflows<a class="headerlink" href="#buffer-overflows" title="Permanent link">&para;</a></h4>
<p>Buffer overflows occur due to improper coding techniques. Specifically this usually occurs when a program writes data to a buffer and then overruns the buffer&rsquo;s boundary and begins to overwrite portions of memory. In buffer overflow exploits the attackers goal is to control a crash and gain code execution on the given system. In a buffer overflow exploit, one of the more common techniques is to overwrite a given register and &ldquo;jump&rdquo; to the shellcode.</p>
<h4 id="seh-overwrites">SEH Overwrites<a class="headerlink" href="#seh-overwrites" title="Permanent link">&para;</a></h4>
<p>SEH overwrites occur when the structured exception handler begins to gracefully close an application. The attacker can manipulate how SEH works, overwrite the base address of the SEH handler and gain control of execution flow through the SEH. This is a common attack leveraged with buffer overflow vulnerability and applications that have been complied with SEH.</p>
<h4 id="return-oriented-programming">Return Oriented Programming<a class="headerlink" href="#return-oriented-programming" title="Permanent link">&para;</a></h4>
<p>Return Oriented Programming (ROP) is a technique used during a portion where the user has control of execution flow however data execution prevention (DEP) or other precluding defense mechanisms may be in place. In the situation where DEP is enabled, the attacker does not have direct access to execute specific assembly instructions, therefor the attacker buildsa ROP gadget in order to prep certain Windows API calls or techniques to disable DEP or circumvent DEP. A common method is leveraging the WriteProcessMemory call to copy data from the stack into a writable memory space that can then be executed.</p>
<h3 id="traffic-analysis">Traffic Analysis<a class="headerlink" href="#traffic-analysis" title="Permanent link">&para;</a></h3>
<p>Traffic analysis is the technique of identifying what type of information is being sent and the ability to understand and manipulate that traffic. A penetration tester should be able to understand how a protocol works and how it can be manipulated in order to leverage an attack.</p>
<h3 id="physical-access">Physical Access<a class="headerlink" href="#physical-access" title="Permanent link">&para;</a></h3>
<p>Physical access during a penetration test can be a viable attack method for attempting to circumvent physical security controls and gain unauthorized access. During a penetration test, the assessor should be able to identify potentially flawed physical security controls and attempt to gain access to the facility if within scope.</p>
<h4 id="human-angle">Human Angle<a class="headerlink" href="#human-angle" title="Permanent link">&para;</a></h4>
<p>During a physical penetration test, some of the most obvious ways would be to social-engineer your way into the facility and gain access. This requires significant knowledge of how the organization performs business, and everything you learned from the intelligence gathering phase.</p>
<h4 id="pc-access">PC Access<a class="headerlink" href="#pc-access" title="Permanent link">&para;</a></h4>
<p>If physical access is granted to a PC, the penetration tester should be able to attack the PC and gain access through multiple methods that would allow access to the system.</p>
<h3 id="proximity-access-wifi">Proximity Access (WiFi)<a class="headerlink" href="#proximity-access-wifi" title="Permanent link">&para;</a></h3>
<p>Wireless communications are an avenue for attacks to gain access through RF type communications. The penetration tester should view the FCC radio frequency list to see if the target has registered spectrum frequencies in use.</p>
<h4 id="wifi-attacks">WiFi Attacks<a class="headerlink" href="#wifi-attacks" title="Permanent link">&para;</a></h4>
<p>Regardless of protocol, there are a number of attacks available for WEP, WPA, WPA2, EAP-FAST, EAP-LEAP, and other avenues. The attacker should be familiar with the various encryption protocols and standards and be able to effectively test the implementation around the controls put in place.</p>
<h4 id="attacking-the-user">Attacking the User<a class="headerlink" href="#attacking-the-user" title="Permanent link">&para;</a></h4>
<p>Leveraging rogue access points in order to attack the victim is often a beneficial and a viable attack method. Leveraging a rogue access point to entice victims in order to leverage exploits or steal sensitive information should be performed during a wireless assessment. There are several common techniques in use of this, but most commonly the attacker would setup a wireless access point with the same name or an enticing name in order for the victim to connect.</p>
<h2 id="example-avenues-of-attack">Example Avenues of Attack<a class="headerlink" href="#example-avenues-of-attack" title="Permanent link">&para;</a></h2>
<p>In any scenario, the attacks should consist based on the scenario that is within scope of the engagement. Below is a list of several attack avenues to consider based on scenario but is by no means a comprehensive list.</p>
<p>Web Application Attacks
Social-Engineering
Physical Attack Avenues
Memory Based Exploits (i.e. buffer/heap overflows, memory corruptions, use-after-free).
Man in the Middle
VLAN Hopping
USB/Flash Drive deployment
Reverse Engineering
Zero-Day Angle
Attacking the user
Encryption Cracking
Graphics Processing Unit (GPU) Cracking
Traffic Analysis
Firewire
Routing protocols
Phishing with Pretexting
Employee Impersonation</p>
<p>Again, these examples are only basic avenues for attack based on the scenario you are performing for the organization. The value from a penetration test comes from creativity and the ability to identify exposures and exploit them in a precise manner.</p>
<h2 id="overall-objective">Overall Objective<a class="headerlink" href="#overall-objective" title="Permanent link">&para;</a></h2>
<p>In the pre-engagement interaction phase with the customer, a clear definition of the overall objectives of the penetration test should have been communicated. In the case of the exploitation phase, the biggest challenge is identifying the least path of resistance into the organization without detection and having the most impact on the organizations ability to generate revenue.  </p>
<p>By performing the prior phases properly, a clear understanding of how the organization functions and makes money should be relatively understood. From the exploitation phase and into the post-exploitation phase, the attack vectors should rely solely on the mission of circumventing security controls in order to represent how the organization can suffer substantial losses through a targeted attack against the organization.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2019 - 2020 darkcode0x00</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
